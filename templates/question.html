<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Our Love Story üíñ - Questions</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<style>
body { margin:0; padding:0; background:black; font-family:sans-serif; overflow-x:hidden; color:white; text-align:center; }
#box { margin-top:20px; z-index:2; position:relative; }
button { margin:5px; padding:10px; font-size:4vw; cursor:pointer; border-radius:8px; background:#ff4081; color:white; border:none; }
.next { margin-top:20px; }
canvas { position:fixed; top:0; left:0; z-index:0; pointer-events:none; }
h2,h1,p { color:white; z-index:2; position:relative; }
</style>
</head>
<body>

<!-- HIDDEN AUDIO IFRAME -->
<iframe src="{{ url_for('audio') }}" style="display:none;" id="musicFrame"></iframe>

<!-- HEARTS CANVAS -->
<canvas id="hearts"></canvas>

<!-- FIREWORKS CANVAS -->
<canvas id="fire"></canvas>

<!-- QUESTIONS -->
<div id="box"></div>

<script>
const questions = [
  {q:"üíñ Who is your forever person?", a:["SUHANA ","CHINNI üòò"]},
  {q:"üíï Who loves ASHU more?", a:["ANANYA üíï","ANUSHA üíó"]},
  {q:"üíç Will you stay with me forever?", a:["YES üíç","ALWAYS ‚ôæÔ∏è"]},
  {q:"üòç Are you mine even after marriage?", a:["FOREVER üòç","No ü•±"]},
  {q:"‚ù§Ô∏è Do you love me?", a:["No ü•±","INFINITE ‚ôæÔ∏è"]},
  {q:"üíñ Will you be my Valentine every year?", a:["No ü•±","FOREVER üíï"]}
];

const box = document.getElementById("box");
let questionIndex = 0;

// HEART RAIN
const heartCanvas = document.getElementById("hearts");
const hctx = heartCanvas.getContext("2d");
heartCanvas.width = window.innerWidth;
heartCanvas.height = window.innerHeight;
let hearts = [];

window.addEventListener("resize", () => { heartCanvas.width = window.innerWidth; heartCanvas.height = window.innerHeight; });

function drawHeart(ctx,x,y,size,color){ctx.save();ctx.fillStyle=color;ctx.beginPath();let t=size*0.3;ctx.moveTo(x,y+t);ctx.bezierCurveTo(x,y,x-size/2,y,x-size/2,y+t);ctx.bezierCurveTo(x-size/2,y+(size+t)/2,x,y+(size+t)/1.5,x,y+size);ctx.bezierCurveTo(x,y+(size+t)/1.5,x+size/2,y+(size+t)/2,x+size/2,y+t);ctx.bezierCurveTo(x+size/2,y,x,y,x,y+t);ctx.closePath();ctx.fill();ctx.restore();}
function createHearts(){hearts.push({x:Math.random()*heartCanvas.width,y:-20,size:Math.random()*15+10,vy:1+Math.random()*3,color:`hsl(${Math.random()*360},100%,70%)`});}
function animateHearts(){hctx.clearRect(0,0,heartCanvas.width,heartCanvas.height);hearts.forEach((h,i)=>{h.y+=h.vy;drawHeart(hctx,h.x,h.y,h.size,h.color);if(h.y>heartCanvas.height)hearts.splice(i,1);});requestAnimationFrame(animateHearts);}
setInterval(createHearts,150);animateHearts();

// FIREWORKS
const canvas=document.getElementById("fire");const ctx=canvas.getContext("2d");canvas.width=window.innerWidth;canvas.height=window.innerHeight;let particles=[];
function fireworks(){let count=Math.floor(window.innerWidth/10);for(let i=0;i<count;i++){particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height/2,vx:(Math.random()-0.5)*14,vy:(Math.random()-0.5)*14,life:120});}}
function animateFireworks(){ctx.fillStyle="rgba(0,0,0,.25)";ctx.fillRect(0,0,canvas.width,canvas.height);particles.forEach((p,i)=>{ctx.fillStyle=`hsl(${Math.random()*360},100%,60%)`;ctx.beginPath();ctx.arc(p.x,p.y,3.5,0,Math.PI*2);ctx.fill();p.x+=p.vx;p.y+=p.vy;p.life--;if(p.life<=0)particles.splice(i,1);});requestAnimationFrame(animateFireworks);}
animateFireworks();

// QUESTIONS
function showQuestion(){
    let html=`<h2 style="color:white;">${questions[questionIndex].q}</h2>`;
    questions[questionIndex].a.forEach(btn=>{ html+=`<button onclick="answer()">${btn}</button>`; });
    html+=`<br><button class="next" id="nextBtn" onclick="nextQuestion()" style="display:none">Next ‚û°Ô∏è</button>`;
    box.innerHTML=html;
}
function answer(){fireworks();document.getElementById("nextBtn").style.display="inline-block";}
function nextQuestion(){questionIndex++;if(questionIndex<questions.length){showQuestion();}else{box.innerHTML=`<h1>üéÜ I LOVE YOU FOREVER üíñ</h1><p>You are my world üåç‚ù§Ô∏è</p>`;setInterval(fireworks,900);}}

window.addEventListener("load",showQuestion);
</script>

</body>
</html>
